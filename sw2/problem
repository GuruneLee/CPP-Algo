자물쇠 열기
소마는 가로와 세로의 크기가 1인 칸으로 이루어진 MM x NN 크기의 지도를 얻었다. 이 지도에는 보물 상자와 열쇠가 있는 위치가 적혀있고 지도에 위치한 보물 상자를 열기 위해서는 열쇠가 반드시 필요하다. 이 보물 상자를 열기 위해 소마는 지도상에서 아래의 조건을 따른다.

소마는 현재 위치에서 상, 하, 좌, 우로만 움직일 수 있다. (단, 지도 밖을 나갈 수는 없다.)

보물 상자를 열거나 열쇠를 얻기 위해서는 보물 상자나 열쇠가 있는 칸으로 들어가야 한다.

지도에는 벽이 있을 수 있으며, 소마는 벽으로 된 칸으로는 이동(통과)할 수 없다.

열쇠가 없는 상태에서 보물 상자 위를 이동하는 것은 가능하다.

예를 들어, EE는 소마의 위치, KK는 열쇠의 위치, GG는 보물 상자의 위치, 그리고 XX는 벽의 위치를 의미할 때 소마가 열쇠를 얻어 보물 상자를 열어 볼 수 있는 상황은 아래와 같다.

img1
▲ 크게보기

위의 예시의 경우 소마는 열쇠로 이동하여 열쇠를 얻고, 보물 상자로 이동하여 보물 상자를 열 수 있다.

반대로 보물 상자를 열어 볼 수 없는 상황은 아래와 같다.

img2
▲ 크게보기

위의 예시의 경우 소마는 열쇠를 얻을 수는 있지만, 열쇠를 얻은 이후 보물 상자를 열 수는 없다.

여러 개의 지도와 각각의 지도에 대한 정보가 주어질 때, 소마가 열쇠를 얻어 보물 상자를 열 수 있는지 여부를 출력하시오.

입력
첫 번째 줄에 지도의 개수 정수 tt를 입력받는다.
1 ≦ t ≦ 10
1≦t≦10
이후 tt 개의 지도에 대하여 지도의 정보를 입력받는다. 지도의 정보를 입력받을 때는 맨 첫 줄에 지도의 가로의 크기인 정수 MM, 그리고 세로의 크기인 정수 NN을 공백을 구분자로 입력받는다.
2 ≦ M, N ≦ 10
2≦M,N≦10
이후 지도를 나타내는 정보를 MM 개의 줄에 거쳐서 입력받는다. 각 줄에 NN 개의 숫자에 대해 공백을 구분자로 입력받는다.
지도에서 0은 빈칸, 1은 벽, 2는 보물 상자, 3은 소마의 위치, 그리고 4는 열쇠의 위치를 나타내며 이 외의 숫자는 입력되지 않는다.
보물 상자, 열쇠, 그리고 소마가 존재하지 않는 경우는 고려하지 않는다.
보물 상자, 열쇠, 벽 그리고 소마의 위치가 겹치는 경우는 고려하지 않는다.
출력
각 지도에 대해 소마가 열쇠를 얻어 보물 상자를 열 수 있으면 1, 아니면 0을 출력한다.
입력 예시
2
5 6
0 0 1 0 2 0
1 0 1 0 0 0
0 0 1 1 1 0
0 3 0 1 0 0
4 0 0 0 0 0
5 6
0 0 1 0 2 0
1 0 1 0 0 0
0 0 1 1 1 0
0 3 0 1 0 0
4 0 0 1 0 0
Copy
출력 예시
1
0


---

무한 회로
NN개의 발판이 주어지고, 각 발판에는 양의 정수 혹은 음의 정수가 적혀있다. 특정 발판을 밟을 경우, 해당 발판에 적혀있는 숫자만큼 좌로 혹은 우로 이동하게 된다. 음수가 적혀 있을 때는 왼쪽으로, 양수가 적혀 있을 때는 오른쪽으로 이동한다. 예를 들어, 아래와 같이 발판이 주어져 있다고 하자.

img1
▲ 크게보기

만약, 소마가 5번째 발판에 있으면 발판의 값이 4이므로 오른쪽으로 4칸 이동한다. 만약 소마가 4번째 발판에 있으면, 발판의 값이 -2이므로 왼쪽으로 2칸 이동한다.

소마는 NN개의 발판 중 아무 곳에서나 발판 밟기를 시작할 수 있다. 발판 밟기를 계속 진행하다 보면, 특정 구간을 계속해서 밟기를 반복하게 되는데 이를 “무한 회로”라고 하자.

예를 들어, 위 예시에서 소마가 1번째 발판에서 발판 밟기를 시작할 경우 아래와 같이 발판을 밟아 나간다.

img2
▲ 크게보기

노란색 발판은 각 회 차별 소마의 위치이며 5회 차부터 살펴보았을 때 소마는 10번째 발판 → 8번째 발판 → 6번째 발판, 다시 10번째 발판 → 8번째 발판 → 6번째 발판 → 이후 반복하며 “무한 회로” 가 발생했음을 알 수 있다. 이때 “무한 회로”의 길이는 3개의 발판(10, 8, 6번째 발판)이 무한히 반복되고 있으므로 3이 된다. 위 규칙을 토대로 예시의 모든 발판에 대해 “무한 회로”를 확인해보았을 때 가장 긴 “무한 회로”는 3임을 알 수 있다.

발판이 주어졌을 때 소마가 마주할 수 있는 모든 “무한 회로” 중 가장 긴 “무한 회로”의 길이를 출력하시오.

입력
첫 번째 줄에 발판의 개수 정수 NN을 입력받는다.
2 ≦ N ≦ 100,000
2≦N≦100,000
두 번째 줄에는 NN 개의 숫자에 대하여 공백을 구분자로 가장 왼쪽부터 순서대로 각각의 발판에 적혀있는 숫자(정수)를 입력받는다.
-10,000 ≦발판의\ 숫자 ≦10,000
−10,000≦발판의 숫자≦10,000

소마가 발판을 밟아 나가다가 발판의 범위를 벗어나는 경우는 고려하지 않는다.

“무한 회로”가 발생하지 않는 경우는 고려하지 않는다.

출력
소마가 마주할 수 있는 모든 “무한 회로” 중 가장 긴 “무한 회로”의 길이를 출력한다.
2 ≦ 무한\ 회로의\ 길이 ≦ 1,000
2≦무한 회로의 길이≦1,000
입력 예시
10
3 5 -1 -2 4 4 3 -2 -3 -2
Copy
출력 예시
3


---

대규모 토지 개발
소마는 가로 세로의 크기가 1로 이뤄진 작은 칸들이 모여 가로와 세로의 크기가 NN인 NN x NN 크기의 토지를 개발하려 한다. (단, NN은 2, 4, 8, 16, 32 중 하나이다) 토지의 각 칸에는 토지를 개발함으로써 얻을 수 있는 이익이 적혀 있으며, 토지는 아래와 같은 형태로 개발한다.

토지를 개발할 때에는 토지를 가로 혹은 세로 절반으로 나누어 한쪽 절반에 해당하는 부분을 모두 활용하여 개발해야 한다.
특정 부분을 모두 활용하여 개발할 때 얻을 수 있는 이익은, 해당 부분에서 개발로 얻을 수 있는 이익 중 최댓값이다.
예를 들어, 아래와 같이 토지가 주어져 있다고 하자.

img1
▲ 크게보기

위의 토지는 아래와 같이 상/하/좌/우로 절반을 나누어 개발을 할 수 있는 4가지 선택지가 있다.

img2
▲ 크게보기

각각의 선택지에 대하여 얻을 수 있는 이익은 해당 면적을 개발하여 얻을 수 있는 이익의 최댓값으로, 이는 왼쪽부터 순서대로 6, 10, 10, 9가 된다. 이렇게 개발을 하고 난 이후에는 해당 면적을 더 개발하지 못하고, 남은 면적으로 반복하여 개발한다. 예를 들어, 처음에 왼쪽 절반을 개발했다고 하자. 그렇게 되면 아래와 같이 4가지 가능성이 존재한다.

img3
▲ 크게보기

이때 얻을 수 있는 이익은 각각 왼쪽부터 순서대로 10, 9, 10, 9이다. 위의 과정을 반복해서 절반씩 개발하다 보면 맨 마지막에는 결국 두 개의 칸이 남게 된다. 그 두 개의 칸을 또 절반으로 나누어 한 개의 칸을 개발하면, 마지막에 최종적으로 하나의 칸이 남게된다. 이와 같이 남은 칸이 1개일 경우에는 해당 칸에서 이익을 얻을 수 없으며 개발을 종료한다. 위 규칙을 토대로 예시의 토지를 모두 개발했을 때 소마는 이익의 합으로 최대 34 만큼의 이익을 얻을 수 있다.

NN x NN 크기인 토지와 각각의 칸에 대한 이익이 주어질 때, 토지 개발을 통해 소마가 얻을 수 있는 이익의 합 중 최댓값을 출력하시오.

입력
첫 번째 줄에 토지의 크기 NN을 입력받는다.
N = 2, 4, 8, 16, 32\ 중\ 하나
N=2,4,8,16,32 중 하나
이후 NN 개의 줄에 대하여 공백을 구분자로 토지 개발을 통해 얻을 수 있는 이익을 입력받는다. (모든 이익은 양의 정수이다.)
1≦ 얻을\ 수\ 있는\ 이익 ≦100,000
1≦얻을 수 있는 이익≦100,000

출력
토지 개발을 통해 소마가 얻을 수 있는 이익의 합 중 최댓값을 출력한다.
이익의\ 합≦1,000,000
이익의 합≦1,000,000
입력 예시
4
1 3 4 5
6 2 9 9
4 3 10 5
5 2 8 6
Copy
출력 예시
34

